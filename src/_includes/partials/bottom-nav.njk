{# =============================================================================
  partials/bottom-nav.njk
  ------------------------------------------------------------------------------
  PURPOSE
  - Mobile-only bottom navigation.
  - Styled like a 2-option segmented control ("slider") between:
      1) Search
      2) Identify

  WHY THIS VERSION
  - Netlify/Eleventy Nunjucks error: "expected block end in set statement"
  - Some Nunjucks configurations are strict about expressions inside {% set %}.
  - This version avoids ALL complex set expressions:
      * no ternary
      * no comparisons in set
      * no method calls
      * no parentheses in set
  - Uses only a simple set + if blocks.

  IMPORTANT
  - No inline CSS.
  - Slider effect is driven by:
      * data-active attribute on <nav>
      * CSS transform on .bottom-nav-indicator
============================================================================= #}

{# ---------------------------------------------------------------------------
  Get current URL safely.
  - If page/url is missing, default to empty string.
--------------------------------------------------------------------------- #}
{% set currentUrl = "" %}
{% if page and page.url %}
  {% set currentUrl = page.url %}
{% endif %}

{# ---------------------------------------------------------------------------
  Determine whether this is an Identify page.
  - We treat any URL that starts with "/identify" as Identify.
  - We avoid startsWith() and avoid complex expressions in set.

  Approach:
  - If URL contains "/identify", we flip isIdentify to true.
--------------------------------------------------------------------------- #}
{% set isIdentify = false %}
{% if currentUrl and (currentUrl | replace("/identify", "")) != currentUrl %}
  {% set isIdentify = true %}
{% endif %}

<nav
  class="bottom-nav"
  aria-label="Primary (mobile)"
  data-active="{% if isIdentify %}identify{% else %}search{% endif %}"
>
  {# Sliding background indicator (purely presentational) #}
  <span class="bottom-nav-indicator" aria-hidden="true"></span>

  <a
    class="bottom-nav-link"
    href="/"
    {% if currentUrl == "/" %}aria-current="page"{% endif %}
  >
    Search
  </a>

  <a
    class="bottom-nav-link"
    href="/identify/"
    {% if isIdentify %}aria-current="page"{% endif %}
  >
    Identify
  </a>
</nav>
