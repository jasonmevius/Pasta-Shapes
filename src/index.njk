---
title: Pasta Shapes
layout: layout.njk
description: "Search pasta shapes by name and aliases, or identify a shape by answering a few quick questions."
---

{# =============================================================================
  index.njk (Homepage - Search)
  ------------------------------------------------------------------------------
  PURPOSE
  - Mobile-first homepage optimized for the restaurant use case.
  - Server-renders the full list (fast first paint, works without JS).
  - Client-side JS filters results as the user types.

  THUMBNAILS
  - The Search page previously rendered an empty <span class="thumb">, which
    created grey boxes. This template now renders an <img> inside that container.
  - Identify page shows thumbs because its JS builds cards differently.

  IMPORTANT RULES
  - NO inline CSS. Styling lives in /src/css/styles.css
============================================================================= #}

{# -----------------------------------------------------------------------------
  ImageKit configuration for thumbnails
----------------------------------------------------------------------------- #}
{% set IK_THUMBS_BASE = "https://ik.imagekit.io/mevius/pasta/thumbs/" %}
{% set FALLBACK_THUMB = "pending.png" %}

<section class="hero stack">
  <h1 class="h1">Pasta Shapes</h1>

  <p class="muted lead">
    Type a pasta name from a menu to see matches (including common aliases).
    If you have a pasta shape in front of you, use Identify to narrow it down by questions.
  </p>
</section>

<section class="card stack" aria-label="Search pasta shapes">
  {# ---------------------------------------------------------------------------
    Search form
    - JS filters the list live as you type.
  --------------------------------------------------------------------------- #}
  <form id="pasta-search-form" class="search" action="/" method="get">
    <label class="sr-only" for="pasta-q">Search</label>
    <input
      id="pasta-q"
      name="q"
      class="search-input"
      type="search"
      inputmode="search"
      autocomplete="off"
      autocapitalize="none"
      spellcheck="false"
      placeholder="Start typing - e.g., ravioli, rigatoni, bucatini"
    />
  </form>

  <div class="results-head">
    <h2 class="h2">Results</h2>
    <p id="pasta-search-status" class="muted" aria-live="polite">
      Start typing to see matches.
    </p>
  </div>

  {# Suggestions (empty by default; JS may populate later) #}
  <ul id="pasta-search-suggestions" class="suggestions" aria-label="Suggestions"></ul>

  {# Recently viewed (per-browser; JS populates) #}
  <div id="recently-viewed-wrap" class="recent-wrap" hidden>
    <h3 class="h3">Recently viewed</h3>
    <p id="recently-viewed" class="muted"></p>
  </div>

  {# ---------------------------------------------------------------------------
    Results list
    - Render server-side so users see real content even if JS is off.
    - JS toggles [hidden] on these <li> items when filtering.
  --------------------------------------------------------------------------- #}
  <ul id="pasta-results" class="results-list" aria-label="Pasta results">
    {% for item in pasta %}

      {# -----------------------------------------------------------------------
        Alias / "Also" line (optional)
        - Use whichever field exists in your data.
      ----------------------------------------------------------------------- #}
      {% set alsoRaw =
        item.SearchAliases
        or item.Aliases
        or item.Synonyms
        or item.Also
        or item.Misspellings
        or ""
      %}

      {# -----------------------------------------------------------------------
        Thumbnail URL normalization

        item.ThumbnailImage may be:
          1) empty
          2) a filename like "penne.png"
          3) a full URL
          4) an older string containing "<ImageKitPath>"

        We normalize to a real URL in all cases.

        NOTE
        - JavaScript string method is startsWith() (capital W).
      ----------------------------------------------------------------------- #}
      {% set thumbRaw = (item.ThumbnailImage or "") | replace("<ImageKitPath>", "") | trim %}
      {% set thumbIsUrl = thumbRaw and thumbRaw.startsWith("http") %}
      {% set thumbFile = (thumbRaw or "") | split("/") | last %}
      {% set thumbUrl = "" %}

      {% if not thumbRaw %}
        {% set thumbUrl = IK_THUMBS_BASE ~ FALLBACK_THUMB %}
      {% elseif thumbIsUrl %}
        {% set thumbUrl = thumbRaw %}
      {% else %}
        {% set thumbUrl = IK_THUMBS_BASE ~ thumbFile %}
      {% endif %}

      {# ImageKit transform for tiny list thumbnails #}
      {% set thumbUrlTransformed = thumbUrl ~ "?tr=w-112,h-112,f-auto,q-50" %}

      <li
        class="result-card"
        data-slug="{{ item.Slug }}"
        data-search=""
      >
        <a class="result-link" href="/pasta/{{ item.Slug }}/" data-recent="1">
          {# Thumbnail container - decorative (name text is the real label) #}
          <span class="thumb" aria-hidden="true">
            <img
              src="{{ thumbUrlTransformed }}"
              alt=""
              loading="lazy"
              decoding="async"
            />
          </span>

          <span class="result-body">
            <span class="result-title-row">
              <span class="result-name">{{ item.ShapeName }}</span>
            </span>

            {% if alsoRaw %}
              <span class="result-also muted">
                Also: {{ alsoRaw }}
              </span>
            {% endif %}
          </span>
        </a>
      </li>
    {% endfor %}
  </ul>

  {# Footer tools for paging (JS controls visibility/text) #}
  <div class="results-tools">
    <p id="pasta-results-note" class="muted"></p>
    <button id="pasta-toggle-all" class="btn secondary btn-small" type="button" hidden>
      Next 10
    </button>
  </div>
</section>
